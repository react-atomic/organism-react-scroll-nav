{"version":3,"file":"main.ee18f0a009c96d3ad053.hot-update.js","sources":["webpack:///../reshow/packages/reshow-flux/build/es/ReduceStore.js","webpack:///../reshow/packages/reshow-flux/build/es/connect.js","webpack:///../reshow/packages/reshow-flux/build/es/connectFunctional.js","webpack:///../reshow/packages/reshow-flux/build/es/connectHook.js","webpack:///../reshow/packages/reshow-flux/build/es/index.js"],"sourcesContent":["import _classCallCheck from \"reshow-runtime/es/helpers/classCallCheck\";\nimport _createClass from \"reshow-runtime/es/helpers/createClass\";\nimport _inherits from \"reshow-runtime/es/helpers/inherits\";\nimport _possibleConstructorReturn from \"reshow-runtime/es/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"reshow-runtime/es/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport { Map } from 'immutable';\nimport { Store } from 'reshow-flux-base';\nimport { toJS } from 'get-object-value';\n\nvar ReduceStore = /*#__PURE__*/function (_Store) {\n  _inherits(ReduceStore, _Store);\n\n  var _super = _createSuper(ReduceStore);\n\n  function ReduceStore() {\n    _classCallCheck(this, ReduceStore);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(ReduceStore, [{\n    key: \"getInitialState\",\n    value: function getInitialState() {\n      return Map();\n    }\n  }, {\n    key: \"getMap\",\n    value: function getMap(k) {\n      return toJS(this.getState().get(k)) || {};\n    }\n  }]);\n\n  return ReduceStore;\n}(Store);\n\nexport default ReduceStore;","import _classCallCheck from \"reshow-runtime/es/helpers/classCallCheck\";\nimport _createClass from \"reshow-runtime/es/helpers/createClass\";\nimport _assertThisInitialized from \"reshow-runtime/es/helpers/assertThisInitialized\";\nimport _inherits from \"reshow-runtime/es/helpers/inherits\";\nimport _possibleConstructorReturn from \"reshow-runtime/es/helpers/possibleConstructorReturn\";\nimport _get from \"reshow-runtime/es/helpers/get\";\nimport _getPrototypeOf from \"reshow-runtime/es/helpers/getPrototypeOf\";\nimport _defineProperty from \"reshow-runtime/es/helpers/defineProperty\";\nimport _objectSpread from \"reshow-runtime/es/helpers/objectSpread2\";\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport dedup from 'array.dedup';\nimport { CHANGE } from 'reshow-flux-base';\nvar DEFAULT_OPTIONS = {\n  withProps: false\n};\nvar keys = Object.keys;\n\nvar getProps = function getProps(props, opt) {\n  return opt.withProps && props ? props : {};\n};\n\nvar getState = function getState(self, prevState, maybeProps, opt) {\n  return self.calculateState(prevState, getProps(maybeProps, opt));\n};\n\nvar getStores = function getStores(self, maybeProps, opt) {\n  return self.getStores(getProps(maybeProps, opt));\n};\n\nvar connect = function connect(Base, options) {\n  var thisOptions = _objectSpread(_objectSpread({}, DEFAULT_OPTIONS), options || {});\n\n  var ConnectedClass = /*#__PURE__*/function (_Base) {\n    _inherits(ConnectedClass, _Base);\n\n    var _super = _createSuper(ConnectedClass);\n\n    function ConnectedClass(props) {\n      var _thisSuper, _thisSuper2, _this;\n\n      _classCallCheck(this, ConnectedClass);\n\n      _this = _super.call(this, props);\n\n      _defineProperty(_assertThisInitialized(_this), \"__stores\", []);\n\n      _defineProperty(_assertThisInitialized(_this), \"__handleChange\", function () {\n        if (!_this.__stores) {\n          // avoid race condition\n          return;\n        }\n\n        var con = _this.constructor;\n\n        _this.setState(function (prevState, currentProps) {\n          return getState(con, prevState, currentProps, thisOptions);\n        });\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"__setStores\", function (stores) {\n        if (_this.__stores) {\n          _this.__resetStores();\n        }\n\n        stores = dedup(stores);\n        (stores || []).forEach(function (store) {\n          return store.addListener(_this.__handleChange, CHANGE);\n        });\n        _this.__stores = stores;\n      });\n\n      _defineProperty(_assertThisInitialized(_this), \"__resetStores\", function () {\n        if (!_this.__stores) {\n          return;\n        }\n\n        _this.__stores.forEach(function (store) {\n          return store.removeListener(_this.__handleChange, CHANGE);\n        });\n\n        _this.__stores = null;\n      });\n\n      var _con = _this.constructor;\n\n      if (!_con.calculateState) {\n        _con.calculateState = _get((_thisSuper = _assertThisInitialized(_this), _getPrototypeOf(ConnectedClass.prototype)), \"calculateState\", _thisSuper);\n      }\n\n      if (!_con.getStores) {\n        _con.getStores = _get((_thisSuper2 = _assertThisInitialized(_this), _getPrototypeOf(ConnectedClass.prototype)), \"getStores\", _thisSuper2);\n      }\n\n      _con.calculateState.bind(_con);\n\n      _con.getStores.bind(_con);\n\n      if (props.withConstructor) {\n        _this.__setStores(getStores(_con, props, thisOptions));\n      }\n\n      if (!_this.state) {\n        _this.state = {};\n      }\n\n      if (!thisOptions.withProps) {\n        var calculatedState = getState(_con, undefined, props, thisOptions);\n\n        if (calculatedState) {\n          keys(calculatedState).forEach(function (key) {\n            return _this.state[key] = calculatedState[key];\n          });\n        }\n      }\n\n      return _this;\n    }\n\n    _createClass(ConnectedClass, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        if (_get(_getPrototypeOf(ConnectedClass.prototype), \"componentDidMount\", this)) {\n          _get(_getPrototypeOf(ConnectedClass.prototype), \"componentDidMount\", this).call(this);\n        }\n\n        if (this.props && !this.props.withConstructor) {\n          this.__setStores(getStores(this.constructor, this.props, thisOptions));\n        }\n      }\n    }, {\n      key: \"componentDidUpdate\",\n      value: function componentDidUpdate(prevProps, prevState) {\n        if (_get(_getPrototypeOf(ConnectedClass.prototype), \"componentDidUpdate\", this)) {\n          _get(_getPrototypeOf(ConnectedClass.prototype), \"componentDidUpdate\", this).call(this, prevProps, prevState);\n        }\n\n        if (thisOptions.withProps) {\n          this.__setStores(getStores(this.constructor, this.props, thisOptions));\n        }\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function componentWillUnmount() {\n        if (_get(_getPrototypeOf(ConnectedClass.prototype), \"componentWillUnmount\", this)) {\n          _get(_getPrototypeOf(ConnectedClass.prototype), \"componentWillUnmount\", this).call(this);\n        }\n\n        this.__resetStores();\n      }\n    }], [{\n      key: \"getDerivedStateFromProps\",\n      value: function getDerivedStateFromProps(nextProps, prevState) {\n        var thisStates = null;\n\n        if (_get(_getPrototypeOf(ConnectedClass), \"getDerivedStateFromProps\", this)) {\n          thisStates = _get(_getPrototypeOf(ConnectedClass), \"getDerivedStateFromProps\", this).call(this, nextProps, prevState);\n        }\n\n        if (thisOptions.withProps && prevState.prevProps !== nextProps) {\n          var calState = getState(ConnectedClass, _objectSpread(_objectSpread({}, prevState), thisStates), nextProps, thisOptions);\n          thisStates = _objectSpread(_objectSpread(_objectSpread({}, thisStates), calState), {}, {\n            prevProps: nextProps\n          });\n        }\n\n        return thisStates;\n      }\n    }]);\n\n    return ConnectedClass;\n  }(Base);\n\n  var componentName = Base.displayName || Base.name;\n  ConnectedClass.displayName = 'FluxConnected(' + componentName + ')';\n  return ConnectedClass;\n};\n\nexport default connect;","import _classCallCheck from \"reshow-runtime/es/helpers/classCallCheck\";\nimport _createClass from \"reshow-runtime/es/helpers/createClass\";\nimport _inherits from \"reshow-runtime/es/helpers/inherits\";\nimport _possibleConstructorReturn from \"reshow-runtime/es/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"reshow-runtime/es/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport React, { PureComponent } from 'react';\nimport connect from './connect';\n\nvar connectFunctional = function connectFunctional(viewFn, _getStores, _calculateState, options) {\n  var FunctionalConnected = /*#__PURE__*/function (_PureComponent) {\n    _inherits(FunctionalConnected, _PureComponent);\n\n    var _super = _createSuper(FunctionalConnected);\n\n    function FunctionalConnected() {\n      _classCallCheck(this, FunctionalConnected);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(FunctionalConnected, [{\n      key: \"render\",\n      value: function render() {\n        return viewFn(this.state);\n      }\n    }], [{\n      key: \"getStores\",\n      value: function getStores(props) {\n        return _getStores(props);\n      }\n    }, {\n      key: \"calculateState\",\n      value: function calculateState(prevState, props) {\n        return _calculateState(prevState, props);\n      }\n    }]);\n\n    return FunctionalConnected;\n  }(PureComponent);\n\n  var viewFnName = viewFn.displayName || viewFn.name || 'FunctionalConnected';\n  FunctionalConnected.displayName = viewFnName;\n  return connect(FunctionalConnected, options);\n};\n\nexport default connectFunctional;\n\n__react_refresh_utils__.registerExportsForReactRefresh(module);\n\nif (module.hot && __react_refresh_utils__.isReactRefreshBoundary(module)) {\n  module.hot.dispose(__react_refresh_utils__.createHotDisposeCallback(module));\n  module.hot.accept(__react_refresh_utils__.createHotErrorHandler(module.id));\n\n  if (!!module.hot.data && !!Object.keys(module.hot.data).length) {\n    if (!module.hot.data.module || __react_refresh_utils__.shouldInvalidateReactRefreshBoundary(module.hot.data.module, module)) {\n      window.location.reload();\n    }\n\n    __react_refresh_utils__.enqueueUpdate();\n  }\n}","import _objectSpread from \"reshow-runtime/es/helpers/objectSpread2\";\nimport _slicedToArray from \"reshow-runtime/es/helpers/slicedToArray\";\nimport \"setimmediate\";\nimport { useMemo, useState, useEffect, useRef } from \"react\";\nimport build from \"reshow-build\";\nimport dedup from \"array.dedup\";\nimport { CHANGE } from \"reshow-flux-base\";\nvar keys = Object.keys;\n\nvar cleanKeys = function cleanKeys(props, state) {\n  if (state) {\n    keys(props || {}).forEach(function (key) {\n      return delete state[key];\n    });\n    return state;\n  }\n};\n\nvar connectHook = function connectHook(Base, options) {\n  var _s = $RefreshSig$();\n\n  var _ref = options || {},\n      getStores = _ref.getStores,\n      calculateState = _ref.calculateState,\n      defaultProps = _ref.defaultProps,\n      displayName = _ref.displayName;\n\n  var Connected = function Connected(props) {\n    _s();\n\n    var _useState = useState(function () {\n      return {\n        state: calculateState({}, props),\n        props: props\n      };\n    }),\n        _useState2 = _slicedToArray(_useState, 2),\n        data = _useState2[0],\n        setData = _useState2[1];\n\n    var _mount = useRef(true);\n\n    useEffect(function () {\n      var stores = dedup(getStores(props)) || [];\n\n      if (stores && stores.length) {\n        var handleChange = function handleChange() {\n          if (_mount.current) {\n            setData(function (prev) {\n              return {\n                __init__: true,\n                props: props,\n                state: _objectSpread(_objectSpread(_objectSpread({}, cleanKeys(prev.props, prev.state)), props), calculateState(prev.state, props))\n              };\n            });\n          }\n        };\n\n        var asyncHandleChange = function asyncHandleChange() {\n          return setImmediate(handleChange);\n        };\n\n        if (!data.__init__ || data.props !== props) {\n          handleChange();\n        }\n\n        stores.forEach(function (store) {\n          return store.addListener(asyncHandleChange, CHANGE);\n        });\n        return function () {\n          stores.forEach(function (store) {\n            return store.removeListener(asyncHandleChange, CHANGE);\n          });\n        };\n      }\n    }, [props]);\n    useEffect(function () {\n      return function () {\n        return _mount.current = false;\n      };\n    }, []);\n    return useMemo(function () {\n      return build(Base)(data.state);\n    }, [data.state]);\n  };\n\n  _s(Connected, \"ueMMp9trlq+SfgLTdnTcNvkxrkc=\");\n\n  var componentName = displayName || Base.displayName || Base.name;\n  Connected.displayName = \"HookConnected(\" + componentName + \")\";\n\n  if (defaultProps) {\n    Connected.defaultProps = defaultProps;\n  }\n\n  return Connected;\n};\n\nexport default connectHook;\n\n__react_refresh_utils__.registerExportsForReactRefresh(module);\n\nif (module.hot && __react_refresh_utils__.isReactRefreshBoundary(module)) {\n  module.hot.dispose(__react_refresh_utils__.createHotDisposeCallback(module));\n  module.hot.accept(__react_refresh_utils__.createHotErrorHandler(module.id));\n\n  if (!!module.hot.data && !!Object.keys(module.hot.data).length) {\n    if (!module.hot.data.module || __react_refresh_utils__.shouldInvalidateReactRefreshBoundary(module.hot.data.module, module)) {\n      window.location.reload();\n    }\n\n    __react_refresh_utils__.enqueueUpdate();\n  }\n}","export { default as connect } from './connect';\nexport { default as connectFunctional } from './connectFunctional';\nexport { default as connectHook } from './connectHook';\nexport { default as ReduceStore } from './ReduceStore';\nexport { Dispatcher } from 'reshow-flux-base';"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACjHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;A","sourceRoot":""}